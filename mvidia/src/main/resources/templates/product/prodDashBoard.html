<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}"
      layout:fragment="content">
<head>
    <meta charset="UTF-8">
    <title>prodDashBoard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<h1>ğŸ“Š ì œí’ˆ ëŒ€ì‹œë³´ë“œ</h1>

<!-- 1. ìš”ì•½ ì§€í‘œ -->
<section class="summary">
    <h2>ìš”ì•½ ì§€í‘œ</h2>
    <ul>
        <li>ì´ë²ˆë‹¬ ë“±ë¡ëœ ìƒì‚° ì œí’ˆ ìˆ˜: ${summary.prodCount}</li>
        <li>ì´ë²ˆë‹¬ ë“±ë¡ëœ ë¶ˆëŸ‰ ì œí’ˆ ìˆ˜: ${summary.defCount}</li>
        <li>ì´ ë¶ˆëŸ‰ë¥ : ${summary.defRate}%</li>
        <li>ì´ë²ˆë‹¬ ì ê²€ ìˆ˜: ${summary.checkCount}</li>
    </ul>
</section>

<!-- 2. ìµœê·¼ ë¶ˆëŸ‰ ì œí’ˆ ë¦¬ìŠ¤íŠ¸ -->
<section class="recent-defective">
    <h2>ìµœê·¼ ë¶ˆëŸ‰ ì œí’ˆ</h2>
    <table border="1" width="100%">
        <thead>
        <tr>
            <th>ì œí’ˆì½”ë“œ</th>
            <th>ì œí’ˆëª…</th>
            <th>ë¶ˆëŸ‰ì‚¬ìœ </th>
            <th>ë“±ë¡ì¼</th>
        </tr>
        </thead>
        <tbody>
        <c:forEach var="item" items="${recentDefective}">
            <tr>
                <td>${item.PROD_CODE}</td>
                <td>${item.PROD_NAME}</td>
                <td>${item.DEF_REASON}</td>
                <td>${item.REG_DATE}</td>
            </tr>
        </c:forEach>
        </tbody>
    </table>
</section>

<!-- 3. TOP5 ì§„í–‰ í˜„í™© (ì°¨íŠ¸) -->
<section class="top5-prog">
    <h2>ì§„í–‰ í˜„í™© TOP 5</h2>
    <canvas id="top5Chart" width="400" height="200"></canvas>
</section>

<script>
    // Controllerì—ì„œ ë‚´ë ¤ì¤€ top5Progë¥¼ JSë¡œ ë³€í™˜
    const top5ProgData = ${top5Prog};

    const labels = top5ProgData.map(item => item.NAME); // ex) ì œí’ˆëª…
    const values = top5ProgData.map(item => item.COUNT); // ex) ê±´ìˆ˜

    new Chart(document.getElementById('top5Chart'), {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: 'ì§„í–‰ í˜„í™© ê±´ìˆ˜',
                data: values
            }]
        }
    });
</script>

</body>
</html>