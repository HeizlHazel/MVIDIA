<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{layout/layout}"
      layout:fragment="content">
<head>
    <meta charset="UTF-8">
    <title>MVIDIA Â· ERP - ê·¼íƒœê´€ë¦¬ Â· ì¶œí‡´ê·¼ ê¸°ë¡</title>
    <style>
        .attManage-Attendance { grid-column: 2; grid-row: 2; background: var(--card); border-radius: var(--radius); box-shadow: var(--shadow); width: 1200px; margin: 0 auto; }
        .attManage-Attendance > .widget { background: #fff; border-radius: 10px; padding: 20px; box-shadow: 0 2px 10px rgba(0, 0, 0, .1); }
        .search-container { display: flex; align-items: center; margin-bottom: 15px; }
        .search-container input, .search-container select { padding: 8px; border: 1px solid #ccc; border-radius: 5px; margin-right: 10px; }
        .search-container button { padding: 8px 12px; border: none; border-radius: 5px; background-color: #0c197f; color: #fff; cursor: pointer; }
        .action-buttons { display: none; }
        .attManage-Attendance .btn { display: inline-flex; align-items: center; gap: 8px; padding: 10px 14px; border-radius: 12px; background-color: #0c197f; color: #fff; }
        .attManage-Attendance .btn:hover { background: #0050be; color: #fff; }
        .attManage-Attendance .ghost {display: inline-flex; align-items: center; gap: 8px; padding: 5px 14px; margin-bottom:5px; border-radius: 12px; background: transparent; color: #002B39; border: 1px solid #002B39; text-decoration:none; }
        .attManage-Attendance .ghost:hover { background: #e7f3f7; }
        .attManage-Attendance .att-cancel-btn {display: inline-flex; align-items: center; gap: 8px; padding: 10px 14px; border-radius: 12px; margin-left: 5px; }
        .attManage-Attendance .att-cancel-btn:hover { background: #e7f3f7; }
    </style>
</head>
<body>
<div class="attManage-Attendance">

    <div class="widget" id="home">

        <h3>ğŸ•˜ ì¶œí‡´ê·¼ ê¸°ë¡ ì¡°íšŒ</h3>
        <br>

        <div class="search-container">
            <input type="text" id="attendanceSearchKeyword" placeholder="ìƒíƒœ" th:value="${param.keyword}">
            <select id="attendanceSearchStatus">
                <option value="" th:selected="${param.status == null or param.status[0] == ''}">ìƒíƒœ ì „ì²´</option>
                <option value="N" th:selected="${param.status != null and param.status[0] == 'N'}">ì •ìƒ</option>
                <option value="T" th:selected="${param.status != null and param.status[0] == 'T'}">ì§€ê°</option>
                <option value="B" th:selected="${param.status != null and param.status[0] == 'B'}">ê²°ê·¼</option>
                <option value="E" th:selected="${param.status != null and param.status[0] == 'E'}">ì¡°í‡´</option>
                <option value="V" th:selected="${param.status != null and param.status[0] == 'V'}">íœ´ê°€</option>
                <option value="O" th:selected="${param.status != null and param.status[0] == 'O'}">ì•¼ê·¼</option>
                <option value="X" th:selected="${param.status != null and param.status[0] == 'X'}">ì¶œì¥</option>
            </select>

            <button id="attendanceSearchBtn">ê²€ìƒ‰</button>
        </div>

        <table class="table mt16">
            <thead><tr><th>#</th><th>ì‚¬ë²ˆ</th><th>ì´ë¦„</th><th>ì¼ì</th><th>ì¶œê·¼</th><th>í‡´ê·¼</th><th>ìƒíƒœ</th></tr></thead>
            <tbody id="attendList">
            <tr th:if="${#lists.isEmpty(attList)}">
                <td colspan="8" style="text-align: center;">ì¡°íšŒëœ ê·¼íƒœ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</td>
            </tr>
            <tr th:unless="${#lists.isEmpty(attList)}" th:each="att : ${attList}">
                <td th:text="${attStat.count}"></td>
                <td th:text="${att.empNo}"></td>
                <td th:text="${att.empName}"></td>
                <td th:text="${att.attDate}"></td>
                <td th:text="${att.arrivingTime}"></td>
                <td th:text="${att.leavingTime}"></td>
                <td th:text="${att.attStatusName}"></td>
            </tr>
            </tbody>
        </table>

        <div class="stack mt8" id="attendancePager" th:if="${pi.listCount > 0}" align="center">
            <a th:if="${pi.currentPage > 1}"
               th:href="@{/attManage/attendanceRecordCheck.attManage(
                                                  cpage=${pi.currentPage-1},
                                                  keyword=${param.keyword},
                                                  status=${param.status})}">&lt;</a>
            <span th:each="p : ${#numbers.sequence(pi.startPage, pi.endPage)}">
                <a th:href="@{/attManage/attendanceRecordCheck.attManage(
                        cpage=${p},
                        keyword=${param.keyword},
                        status=${param.status})}"
                   th:text="${p}"
                   th:class="${pi.currentPage eq p ? 'active' : ''}"></a>
            </span>
            <a th:href="@{/attManage/attendanceRecordCheck.attManage(
                      cpage=${pi.currentPage+1},
                      keyword=${param.keyword},
                      status=${param.status})}"
               th:if="${pi.currentPage < pi.maxPage}">&gt;</a>
        </div>
    </div>
</div>
<script th:inline="javascript">
    const contextPath = [[@{/}]];

    // ê²€ìƒ‰ ë²„íŠ¼ í´ë¦­ ì‹œ
    $('#attendanceSearchBtn').on('click', function() {
        const keyword = $('#attendanceSearchKeyword').val();
        const status = $('#attendanceSearchStatus').val();

        window.location.href = contextPath + 'attManage/attendanceRecordCheck.attManage?cpage=1&keyword=' + encodeURIComponent(keyword) + '&status=' + encodeURIComponent(status);
    });
</script>
</body>
</html>