<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{layout/layout}"
      layout:fragment="content">
<head>
    <meta charset="UTF-8">
    <title>ğŸ“° ì¦ëª…ì„œ ì¡°íšŒ/ ë°œê¸‰</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: "Malgun Gothic","Apple SD Gothic Neo",system-ui,-apple-system,Segoe UI,Roboto,sans-serif; background-color: #f0f2f5; }
        .certificate-page { display: none; }
        .certificate-document {
            max-width: 210mm; margin: 0 auto; padding: 20mm;
            border: 1px solid #e5e7eb; background: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        @page { size: A4; margin: 20mm; }
        @media print { .actions { display: none; } .certificate-document { border: none; padding: 0; box-shadow: none; } }

        /* ê¸°ì¡´ ìŠ¤íƒ€ì¼ ë³‘í•© ë° TailwindCSS í´ë˜ìŠ¤ë¡œ ëŒ€ì²´ */
        .certificate{grid-column:2;grid-row:2; background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);}
        .certificate>.widget{background:#fff;border-radius:10px;padding:20px;box-shadow:0 2px 10px rgba(0,0,0,.1)}
        .page-title{font-size:20px;margin:0 0 12px 0}
        .stack{display:flex;gap:10px;flex-wrap:wrap}
        .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;background-color:#0c197f ;color:#fff}
        .certificate .btn:hover{background:#00BDA7;color:#fff;}
        .btn.alt{background:#0f7a90}
        .btn.warn{background:var(--warn)}
        .btn.danger{background:var(--danger)}
        .btn.ghost{background:transparent;color:#002B39;border:1px solid #002B39}
        .modal-body .input-group {display: flex; gap: 10px; align-items: center;}
        .modal-body .btn:hover{background:#0050be; color:#fff;}
        .emp-info { display: none; margin-top: 15px; padding: 15px; border-radius: 8px; background-color: #f0f4f7;}
        .emp-info .name, .emp-info .dept { font-weight: bold;}
        .error-message { display: none; color: #ef4444; margin-top: 10px;}
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); display: none; justify-content: center; align-items: center; z-index: 1000; }
        .modal-content { background: #fff; padding: 24px; border-radius: 12px; max-width: 400px; width: 90%; position: relative; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #e2e8f0; padding-bottom: 16px; margin-bottom: 16px; }
        .close-btn { background: none; border: none; font-size: 24px; cursor: pointer; }
    </style>
</head>
<body>
<!-- ë©”ì¸ ì»¨í…ì¸  -->
<div class="certificate" id="main-content">
    <h2 class="page-title">ğŸ“° ì¦ëª…ì„œ ì¡°íšŒ/ ë°œê¸‰</h2>
    <div class="widget" id="home">
        <div class="stack">
            <a class="btn" onclick="openModal('employment')">ì¬ì§ ì¦ëª…ì„œ</a>
            <a class="btn" onclick="openModal('career')">ê²½ë ¥ ì¦ëª…ì„œ</a>
            <a class="btn" onclick="openModal('payslip')">ê¸‰ì—¬ ëª…ì„¸ì„œ</a>
            <a class="btn ghost" href="/mainPage">ë©”ì¸ìœ¼ë¡œ</a>
        </div>
    </div>
</div>

<!-- ì¦ëª…ì„œ ë° ê¸‰ì—¬ ëª…ì„¸ì„œ ë Œë”ë§ ì˜ì—­ -->
<div id="certificate-container" class="certificate-page"></div>

<!-- ê³µí†µ ëª¨ë‹¬ -->
<div class="modal-overlay" id="commonModal">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="modalTitle"></h5>
            <button type="button" class="close-btn" onclick="closeModal()">&times;</button>
        </div>
        <div class="modal-body">
            <div class="input-group">
                <input id="empNo" class="form-control rounded-lg px-4 py-2 border w-full" type="text" placeholder="ì‚¬ë²ˆ ì…ë ¥ (ì˜ˆ: 12345678)" maxlength="8" />
            </div>
            <div class="emp-info" id="empInfo">
                <p><strong>ì´ë¦„:</strong> <span id="empName"></span></p>
                <p><strong>ì§ê¸‰:</strong> <span id="empRank"></span></p>
                <p><strong>ë¶€ì„œ:</strong> <span id="empDept"></span></p>
                <button class="btn mt-4" id="btnConfirmIssue">ë°œê¸‰ ì§„í–‰</button>
            </div>
            <div class="emp-info hidden" id="payslipInfo">
                <p><strong>ë°œê¸‰ë…„ì›”:</strong> <span id="payslipDate"></span></p>
                <button class="btn mt-4" id="btnConfirmPayslip">ì¡°íšŒ ì§„í–‰</button>
            </div>
            <p class="error-message" id="errorMsg"></p>
        </div>
    </div>
</div>

<script>
    // í˜„ì¬ ì„ íƒëœ ì¦ëª…ì„œ íƒ€ì… (employment, career, payslip)
    let currentCertificateType = '';

    // ëª¨ë‹¬ ì—´ê¸° í•¨ìˆ˜
    function openModal(type) {
        currentCertificateType = type;
        document.getElementById('main-content').style.display = 'none';
        document.getElementById('commonModal').style.display = 'flex';
        document.getElementById('empNo').value = '';
        document.getElementById('empInfo').style.display = 'none';
        document.getElementById('payslipInfo').style.display = 'none';
        document.getElementById('errorMsg').style.display = 'none';

        let title = '';
        if (type === 'employment') {
            title = 'ì¬ì§ ì¦ëª…ì„œ ë°œê¸‰';
            document.getElementById('empInfo').style.display = 'block';
        } else if (type === 'career') {
            title = 'ê²½ë ¥ ì¦ëª…ì„œ ë°œê¸‰';
            document.getElementById('empInfo').style.display = 'block';
        } else if (type === 'payslip') {
            title = 'ê¸‰ì—¬ ëª…ì„¸ì„œ ì¡°íšŒ';
            document.getElementById('payslipInfo').style.display = 'block';
        }
        document.getElementById('modalTitle').innerText = title;
    }

    // ëª¨ë‹¬ ë‹«ê¸° í•¨ìˆ˜
    function closeModal() {
        document.getElementById('main-content').style.display = 'block';
        document.getElementById('commonModal').style.display = 'none';
    }

    // ì‚¬ë²ˆ ì…ë ¥ ì‹œ ë™ì  ì¡°íšŒ (ê³µí†µ)
    document.getElementById('empNo').addEventListener('input', async function() {
        const empNo = this.value;
        const infoSelector = document.getElementById('empInfo');
        const payslipInfoSelector = document.getElementById('payslipInfo');
        const errorSelector = document.getElementById('errorMsg');

        infoSelector.style.display = 'none';
        payslipInfoSelector.style.display = 'none';
        errorSelector.style.display = 'none';

        if (empNo.length === 8) {
            try {
                const response = await fetch(`/api/certificate/employee?empNo=${empNo}`);
                const employee = await response.json();

                if (response.ok && employee) {
                    if (currentCertificateType === 'payslip') {
                         payslipInfoSelector.style.display = 'block';
                         document.getElementById('payslipDate').innerText = '2025ë…„ 08ì›” 01ì¼'; // ì˜ˆì œ ë°ì´í„°
                    } else {
                        infoSelector.style.display = 'block';
                        document.getElementById('empName').innerText = employee.empName;
                        document.getElementById('empRank').innerText = employee.jobName;
                        document.getElementById('empDept').innerText = employee.deptName;
                    }
                } else {
                    errorSelector.innerText = 'ì‚¬ë²ˆì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                    errorSelector.style.display = 'block';
                }
            } catch (error) {
                console.error('Error fetching employee data:', error);
                errorSelector.innerText = 'ì„œë²„ í†µì‹  ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
                errorSelector.style.display = 'block';
            }
        } else if (empNo.length > 8) {
            errorSelector.innerText = 'ì‚¬ë²ˆì´ 8ìë¦¬ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤.';
            errorSelector.style.display = 'block';
        }
    });

    // 'ë°œê¸‰ ì§„í–‰' ë²„íŠ¼ í´ë¦­ ì‹œ ì´ë²¤íŠ¸ (ì¬ì§/ê²½ë ¥)
    document.getElementById('btnConfirmIssue').addEventListener('click', async function() {
        const empNo = document.getElementById('empNo').value;
        try {
            const response = await fetch(`/api/certificate/employee?empNo=${empNo}`);
            const employeeData = await response.json();
            if (response.ok && employeeData) {
                renderCertificatePage(employeeData, currentCertificateType);
                closeModal();
            } else {
                document.getElementById('errorMsg').innerText = 'ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
                document.getElementById('errorMsg').style.display = 'block';
            }
        } catch (error) {
            console.error('Error rendering certificate:', error);
            document.getElementById('errorMsg').innerText = 'í˜ì´ì§€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
            document.getElementById('errorMsg').style.display = 'block';
        }
    });

    // 'ì¡°íšŒ ì§„í–‰' ë²„íŠ¼ í´ë¦­ ì‹œ ì´ë²¤íŠ¸ (ê¸‰ì—¬ ëª…ì„¸ì„œ)
    document.getElementById('btnConfirmPayslip').addEventListener('click', async function() {
        const empNo = document.getElementById('empNo').value;
         try {
            const response = await fetch(`/api/certificate/payslip?empNo=${empNo}`);
            const payslipData = await response.json();
            if (response.ok && payslipData) {
                renderPayslipPage(payslipData);
                closeModal();
            } else {
                document.getElementById('errorMsg').innerText = 'ê¸‰ì—¬ ëª…ì„¸ì„œ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                document.getElementById('errorMsg').style.display = 'block';
            }
        } catch (error) {
            console.error('Error fetching payslip:', error);
            document.getElementById('errorMsg').innerText = 'ê¸‰ì—¬ ëª…ì„¸ì„œ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
            document.getElementById('errorMsg').style.display = 'block';
        }
    });

    // ì¬ì§ì¦ëª…ì„œ HTML í…œí”Œë¦¿
    const employmentTemplate = (data) => `
        <div class="actions flex justify-end gap-2 mb-2">
            <button class="btn bg-blue-600 text-white hover:bg-blue-700 rounded-lg px-4 py-2" onclick="issueCertificate('employment', ${data.empNo})">ë°œê¸‰</button>
            <button class="btn bg-gray-500 text-white hover:bg-gray-600 rounded-lg px-4 py-2" onclick="window.print()">ì¸ì‡„</button>
            <button class="btn bg-gray-500 text-white hover:bg-gray-600 rounded-lg px-4 py-2" onclick="goBack()">ëŒì•„ê°€ê¸°</button>
        </div>
        <section class="certificate-document p-8">
            <h1 class="text-center text-3xl font-bold tracking-wide text-gray-800 mb-8">ì¬ì§ì¦ëª…ì„œ</h1>
            <table class="w-full border-collapse">
                <tr><th class="border border-gray-300 p-3 bg-gray-50 text-left w-1/4 font-semibold">ì„±ëª…</th><td class="border border-gray-300 p-3">${data.empName}</td></tr>
                <tr><th class="border border-gray-300 p-3 bg-gray-50 text-left font-semibold">ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸</th><td class="border border-gray-300 p-3">${data.rrn}</td></tr>
                <tr><th class="border border-gray-300 p-3 bg-gray-50 text-left font-semibold">ì£¼ì†Œ</th><td class="border border-gray-300 p-3">${data.address}</td></tr>
                <tr><th class="border border-gray-300 p-3 bg-gray-50 text-left font-semibold">ì†Œì†</th><td class="border border-gray-300 p-3">${data.deptName}</td></tr>
                <tr><th class="border border-gray-300 p-3 bg-gray-50 text-left font-semibold">ì§ìœ„</th><td class="border border-gray-300 p-3">${data.jobName}</td></tr>
                <tr><th class="border border-gray-300 p-3 bg-gray-50 text-left font-semibold">ê¸°ê°„</th><td class="border border-gray-300 p-3">${data.hireDate} ~ í˜„ì¬</td></tr>
            </table>
            <div class="mt-8 text-sm leading-relaxed">
                ìƒê¸°ì™€ ê°™ì´ ì¬ì§ ì¤‘ì„ì„ ì¦ëª…í•¨<br>
                ìš©&nbsp;&nbsp;ë„ : ${data.purpose}
            </div>
            <div class="mt-12 text-center">
                <div class="date mb-4 text-lg font-semibold">${new Date().toLocaleDateString('ko-KR', { year: 'numeric', month: 'long', day: 'numeric' })}</div>
                <div class="company mt-4 text-sm leading-relaxed">
                    ì£¼&nbsp;&nbsp;&nbsp;&nbsp;ì†Œ : ${data.companyAddress}<br>
                    íšŒ ì‚¬ ëª… : ${data.companyName}<br>
                    ëŒ€ í‘œ ì´ ì‚¬ : ${data.ceoName} (ì¸)
                </div>
            </div>
            <div class="seal absolute bottom-8 right-8 w-16 h-16 border-2 border-dashed border-red-500 rounded-lg flex items-center justify-center text-red-500 font-bold text-xs">íšŒì‚¬ì¸</div>
        </section>
    `;

    // ê²½ë ¥ì¦ëª…ì„œ HTML í…œí”Œë¦¿
    const careerTemplate = (data) => `
        <div class="actions flex justify-end gap-2 mb-2">
            <button class="btn bg-blue-600 text-white hover:bg-blue-700 rounded-lg px-4 py-2" onclick="issueCertificate('career', ${data.empNo})">ë°œê¸‰</button>
            <button class="btn bg-gray-500 text-white hover:bg-gray-600 rounded-lg px-4 py-2" onclick="window.print()">ì¸ì‡„</button>
            <button class="btn bg-gray-500 text-white hover:bg-gray-600 rounded-lg px-4 py-2" onclick="goBack()">ëŒì•„ê°€ê¸°</button>
        </div>
        <section class="certificate-document p-8">
            <h1 class="text-center text-3xl font-bold tracking-wide text-gray-800 mb-8">ê²½ë ¥ì¦ëª…ì„œ</h1>
            <h2 class="section-title font-bold text-lg mt-8 mb-4">ì¸ì  ì‚¬í•­</h2>
            <table class="w-full border-collapse">
                <tr><th class="border border-gray-300 p-3 bg-gray-50 text-left w-1/4 font-semibold">ì„±ëª…</th><td class="border border-gray-300 p-3">${data.empName}</td></tr>
                <tr><th class="border border-gray-300 p-3 bg-gray-50 text-left font-semibold">ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸</th><td class="border border-gray-300 p-3">${data.rrn}</td></tr>
                <tr><th class="border border-gray-300 p-3 bg-gray-50 text-left font-semibold">ì „í™”ë²ˆí˜¸</th><td class="border border-gray-300 p-3">${data.phone}</td></tr>
                <tr><th class="border border-gray-300 p-3 bg-gray-50 text-left font-semibold">ì£¼ì†Œ</th><td class="border border-gray-300 p-3">${data.address}</td></tr>
            </table>
            <h2 class="section-title font-bold text-lg mt-8 mb-4">ì—…ì²´ ì •ë³´</h2>
            <table class="w-full border-collapse">
                <tr><th class="border border-gray-300 p-3 bg-gray-50 text-left w-1/4 font-semibold">ì—…ì²´ëª…</th><td class="border border-gray-300 p-3">${data.companyName}</td></tr>
                <tr><th class="border border-gray-300 p-3 bg-gray-50 text-left font-semibold">ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸</th><td class="border border-gray-300 p-3">${data.bizRegNo}</td></tr>
                <tr><th class="border border-gray-300 p-3 bg-gray-50 text-left font-semibold">ì „í™”ë²ˆí˜¸</th><td class="border border-gray-300 p-3">${data.companyPhone}</td></tr>
                <tr><th class="border border-gray-300 p-3 bg-gray-50 text-left font-semibold">ì£¼ì†Œ</th><td class="border border-gray-300 p-3">${data.companyAddress}</td></tr>
            </table>
            <h2 class="section-title font-bold text-lg mt-8 mb-4">ê²½ë ¥ ì‚¬í•­</h2>
            <table class="w-full border-collapse text-center">
                <thead><tr><th class="border border-gray-300 p-3 bg-gray-50 font-semibold">ê·¼ë¬´ê¸°ê°„</th><th class="border border-gray-300 p-3 bg-gray-50 font-semibold">ê·¼ë¬´ë¶€ì„œ</th><th class="border border-gray-300 p-3 bg-gray-50 font-semibold">ë‹´ë‹¹ì—…ë¬´</th></tr></thead>
                <tbody>
                    ${data.careerRows.map(row => `<tr><td class="border border-gray-300 p-3">${row.start} ~ ${row.current ? 'í˜„ì¬' : row.end}</td><td class="border border-gray-300 p-3">${row.department}</td><td class="border border-gray-300 p-3">${row.role}</td></tr>`).join('')}
                </tbody>
            </table>
            <div class="grid grid-cols-2 gap-8 mt-8">
                <table class="w-full border-collapse">
                    <tr><th class="border border-gray-300 p-3 bg-gray-50 text-left font-semibold">í™•ì¸ì ì§ìœ„</th><td class="border border-gray-300 p-3">${data.confirmerPosition}</td></tr>
                    <tr><th class="border border-gray-300 p-3 bg-gray-50 text-left font-semibold">í™•ì¸ì ì„±ëª…</th><td class="border border-gray-300 p-3">${data.confirmerName}</td></tr>
                    <tr><th class="border border-gray-300 p-3 bg-gray-50 text-left font-semibold">ìš©ë„</th><td class="border border-gray-300 p-3">${data.purpose}</td></tr>
                </table>
                <div class="issuer flex items-start justify-center gap-6 flex-wrap mt-8 text-sm leading-relaxed">
                    <div class="company-block text-center">
                        <div><strong class="font-bold">${new Date().toLocaleDateString('ko-KR', { year: 'numeric', month: 'long', day: 'numeric' })}</strong></div>
                        <div>íšŒì‚¬ëª… : ${data.companyName}</div>
                        <div>ëŒ€í‘œ : ${data.ceoName} (ì¸)</div>
                    </div>
                    <div class="seal min-w-16 min-h-16 border-2 border-dashed border-red-500 rounded-lg flex items-center justify-center font-bold text-red-500 text-xs p-4">íšŒì‚¬ì¸</div>
                </div>
            </div>
        </section>
    `;

    // ê¸‰ì—¬ ëª…ì„¸ì„œ HTML í…œí”Œë¦¿
    const payslipTemplate = (data) => `
        <div class="actions flex justify-end gap-2 mb-2">
            <button class="btn bg-blue-600 text-white hover:bg-blue-700 rounded-lg px-4 py-2" onclick="goBack()">ëŒì•„ê°€ê¸°</button>
        </div>
        <section class="certificate-document p-8">
            <h1 class="text-center text-3xl font-bold tracking-wide text-gray-800 mb-8">ê¸‰ì—¬ ëª…ì„¸ì„œ</h1>
            <div class="grid grid-cols-2 gap-4 text-sm mb-6">
                <div><span class="font-semibold">ì´ë¦„:</span> ${data.name}</div>
                <div><span class="font-semibold">ì‚¬ë²ˆ:</span> ${data.empNo}</div>
                <div><span class="font-semibold">ì§€ê¸‰ì¼:</span> ${data.payDate}</div>
                <div><span class="font-semibold">ì§ê¸‰:</span> ${data.position}</div>
            </div>

            <h2 class="section-title font-bold text-lg mt-8 mb-4">ì§€ê¸‰ ë‚´ì—­</h2>
            <table class="w-full border-collapse">
                <thead><tr><th class="border border-gray-300 p-3 bg-gray-50 text-left">í•­ëª©</th><th class="border border-gray-300 p-3 bg-gray-50 text-right">ê¸ˆì•¡</th></tr></thead>
                <tbody>
                    <tr><td class="border border-gray-300 p-3">ê¸°ë³¸ê¸‰</td><td class="border border-gray-300 p-3 text-right">${data.baseSalary.toLocaleString('ko-KR')}ì›</td></tr>
                    <tr><td class="border border-gray-300 p-3">ì‹ëŒ€</td><td class="border border-gray-300 p-3 text-right">${data.mealAllowance.toLocaleString('ko-KR')}ì›</td></tr>
                    <tr><td class="border border-gray-300 p-3">ì„±ê³¼ê¸‰</td><td class="border border-gray-300 p-3 text-right">${data.bonus.toLocaleString('ko-KR')}ì›</td></tr>
                </tbody>
                <tfoot>
                    <tr><td class="border border-gray-300 p-3 font-bold">ì´ ì§€ê¸‰ì•¡</td><td class="border border-gray-300 p-3 font-bold text-right">${data.totalPay.toLocaleString('ko-KR')}ì›</td></tr>
                </tfoot>
            </table>

            <h2 class="section-title font-bold text-lg mt-8 mb-4">ê³µì œ ë‚´ì—­</h2>
            <table class="w-full border-collapse">
                <thead><tr><th class="border border-gray-300 p-3 bg-gray-50 text-left">í•­ëª©</th><th class="border border-gray-300 p-3 bg-gray-50 text-right">ê¸ˆì•¡</th></tr></thead>
                <tbody>
                    <tr><td class="border border-gray-300 p-3">êµ­ë¯¼ì—°ê¸ˆ</td><td class="border border-gray-300 p-3 text-right">${data.nationalPension.toLocaleString('ko-KR')}ì›</td></tr>
                    <tr><td class="border border-gray-300 p-3">ê±´ê°•ë³´í—˜</td><td class="border border-gray-300 p-3 text-right">${data.healthInsurance.toLocaleString('ko-KR')}ì›</td></tr>
                    <tr><td class="border border-gray-300 p-3">ê³ ìš©ë³´í—˜</td><td class="border border-gray-300 p-3 text-right">${data.employmentInsurance.toLocaleString('ko-KR')}ì›</td></tr>
                    <tr><td class="border border-gray-300 p-3">ì†Œë“ì„¸</td><td class="border border-gray-300 p-3 text-right">${data.incomeTax.toLocaleString('ko-KR')}ì›</td></tr>
                </tbody>
                <tfoot>
                    <tr><td class="border border-gray-300 p-3 font-bold">ì´ ê³µì œì•¡</td><td class="border border-gray-300 p-3 font-bold text-right">${data.totalDeduction.toLocaleString('ko-KR')}ì›</td></tr>
                </tfoot>
            </table>

            <div class="mt-8 text-center text-2xl font-bold">
                ì‹¤ìˆ˜ë ¹ì•¡: ${data.netPay.toLocaleString('ko-KR')}ì›
            </div>
        </section>
    `;

    function renderCertificatePage(data, type) {
        const container = document.getElementById('certificate-container');
        container.style.display = 'block';
        let html = '';
        if (type === 'employment') {
            html = employmentTemplate(data);
        } else if (type === 'career') {
            html = careerTemplate(data);
        }
        container.innerHTML = html;
    }

    function renderPayslipPage(data) {
        const container = document.getElementById('certificate-container');
        container.style.display = 'block';
        container.innerHTML = payslipTemplate(data);
    }

    // ë°œê¸‰ ë²„íŠ¼ í´ë¦­ ì‹œ ë°±ì—”ë“œ í˜¸ì¶œ
    async function issueCertificate(type, empNo) {
        const issueData = {
            type: type,
            empNo: empNo
        };
        try {
            const response = await fetch('/api/certificate/issue', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(issueData)
            });
            const result = await response.json();
            if (response.ok) {
                alert('ì¦ëª…ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ë°œê¸‰ë˜ì–´ ë…¸ì…˜ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
            } else {
                alert('ì¦ëª…ì„œ ë°œê¸‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + result.message);
            }
        } catch (error) {
            console.error('Issue failed:', error);
            alert('ì¦ëª…ì„œ ë°œê¸‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
    }

    // ëŒì•„ê°€ê¸° ë²„íŠ¼
    function goBack() {
        document.getElementById('certificate-container').style.display = 'none';
        document.getElementById('main-content').style.display = 'block';
    }
</script>
</body>
</html>
