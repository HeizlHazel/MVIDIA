<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{layout/layout}"
      layout:fragment="content">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        .accountCreate{grid-column:2; grid-row:2; background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);}
        .accountCreate>.widget{background:#fff;border-radius:10px;padding:20px;box-shadow:0 2px 10px rgba(0,0,0,.1)}
        .form{display:grid;grid-template-columns:repeat(2,minmax(220px,1fr));gap:14px}
        .accountCreate .profile-section {display: flex; align-items: left; gap: 20px; margin-bottom: 15px;}
        .profile-pic {width: 80px; height: 80px; border-radius: 50%; object-fit: cover; border: 1px solid #ddd;}
        .file-input-group {flex-grow: 1;}
        .form .field{display:flex;flex-direction:column;gap:8px}
        .form label{font-size:12px;color:var(--muted)}
        .form input,.form select,.form textarea{padding:10px 12px;border-radius:12px;border:1px solid #dde6ec;background:#fff;outline:none}
        .form input[readonly]{background:#f1f5f8;color:#6f7c83}
        .form .full{grid-column:1/-1}
        .form .actions{grid-column:1/-1;display:flex;gap:8px;margin-top:6px}
        .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;background-color:#0c197f ;color:#fff}
        .btn.ghost{background:transparent;color:#002B39;border:1px solid #002B39}
    </style>
</head>
<body>

<!-- ë©”ì¸ ì»¨í…ì¸  -->
<div class="accountCreate">
    <h2 class="page-title">ğŸ“ ì‚¬ì› ê³„ì • ì •ë³´ ë“±ë¡</h2>
    <div class="widget" id="home">
        <form id="createForm" class="form" action="/insertInfo.emp" method="post" enctype="multipart/form-data">
                <div class="profile-section field full">
                    <img id="profile-preview" class="profile-pic" th:src="@{/images/default_profile.png}" alt="í”„ë¡œí•„"/>
                    <div class="file-input-group">
                        <label style="margin-right:10px;">í”„ë¡œí•„ ì‚¬ì§„</label>
                        <br>
                        <span>ë“±ë¡í•  í”„ë¡œí•„ ì‚¬ì§„ : </span>
                        <input name="atchFile" type="file" accept="image/*" onchange="previewProfilePic(event)"/>
                    </div>
                </div>
            <div class="field"><label>ì„±*</label><input name="empLName" required /></div>
            <div class="field"><label>ì´ë¦„*</label><input name="empName" required /></div>
            <div class="field"><label>ì˜ë¬¸ ì„±*</label><input name="empEngLName" required /></div>
            <div class="field"><label>ì˜ë¬¸ ì´ë¦„*</label><input name="empEngName" /></div>
            <div class="field"><label>ìƒë…„ì›”ì¼*</label><input name="birthday" type="date" required /></div>
            <div class="field"><label>ë¶€ì„œ*</label>
                <select name="deptCode" required>
                    <option value="">ì„ íƒ</option>
                    <option value="D1">ì¸ì‚¬íŒ€</option>
                    <option value="D2">ê²½ì˜ê´€ë¦¬íŒ€</option>
                    <option value="D3">ìƒì‚°í’ˆì§ˆê´€ë¦¬íŒ€</option>
                    <option value="D4">ê¸°ìˆ ì§€ì›íŒ€</option>
                </select>
            </div>
            <div class="field"><label>ì§ê¸‰*</label>
                <select name="jobNo" required>
                    <option value="">ì„ íƒ</option>
                    <option value="5">ì‚¬ì›</option>
                    <option value="4">ëŒ€ë¦¬</option>
                    <option value="3">ê³¼ì¥</option>
                    <option value="2">ì°¨ì¥</option>
                    <option value="1">ë¶€ì¥</option>
                </select>
            </div>
            <div class="field full"><label>ì£¼ì†Œ*</label><input name="address" required/></div>
            <div class="field"><label>ì „í™”ë²ˆí˜¸*</label><input name="phone" placeholder="010-0000-0000" required /></div>
            <div class="field"><label>ë‚´ì„ ë²ˆí˜¸</label><input name="extNo" placeholder="1234" /></div>
            <div class="field"><label>ì…ì‚¬ì¼*</label><input name="hireDate" type="date" required/></div>
            <input type="hidden" id="jobCode" name="jobCode">
            <div class="actions">
                <button class="btn" type="submit">ê³„ì • ì •ë³´ ë“±ë¡</button>
                <a class="btn ghost" th:href="@{/hr/empAccount.hr}">ì·¨ì†Œ</a>
            </div>
        </form>

        <script>
            $(document).ready(function() {
                // ë¶€ì„œ ë˜ëŠ” ì§ê¸‰ ì„ íƒì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ í•¨ìˆ˜ ì‹¤í–‰
                $('select[name="deptCode"], select[name="jobNo"]').on('change', function() {
                    updateJobCode();
                });

                // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°ê°’ ì„¤ì •
                updateJobCode();

                // job_codeë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
                function updateJobCode() {
                    const deptCode = $('select[name="deptCode"]').val();
                    const jobNo = $('select[name="jobNo"]').val();

                    let deptInitial = "";

                    // ë¶€ì„œ ì½”ë“œ(D1, D2)ë¥¼ Jì½”ë“œë¡œ ë³€í™˜
                    switch(deptCode) {
                        case 'D1':
                            deptInitial = 'J1';
                            break;
                        case 'D2':
                            deptInitial = 'J2';
                            break;
                        case 'D3':
                            deptInitial = 'J3';
                            break;
                        case 'D4':
                            deptInitial = 'J4';
                            break;
                    }

                    // ë‘ ê°’ì´ ëª¨ë‘ ì„ íƒë˜ì—ˆì„ ë•Œë§Œ job_code ì¡°í•©
                    if (deptInitial && jobNo) {
                        const combinedCode = deptInitial + jobNo;
                        $("#jobCode").val(combinedCode);
                    } else {
                        // í•˜ë‚˜ë¼ë„ ì„ íƒë˜ì§€ ì•Šì•˜ë‹¤ë©´ ê°’ ì´ˆê¸°í™”
                        $("#jobCode").val("");
                    }
                }
            });

        function previewProfilePic(event) {
        const reader = new FileReader();
        const output = document.getElementById('profile-preview');
        reader.onload = function(){
            output.src = reader.result;
        };
        reader.readAsDataURL(event.target.files[0]);
    }
        </script>

    </div>
</div>
</body>
</html>