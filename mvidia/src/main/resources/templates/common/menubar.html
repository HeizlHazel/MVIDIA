<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      th:fragment="menubar">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
    <title>Title</title>
    <style>
        .sb{width:250px;min-height:100vh;background:linear-gradient(to bottom,#002B39,#003661,#186AEA);padding-top:60px;position:fixed;left:0;top:0;z-index:999}
        .menu{list-style:none;margin:0;padding:0}
        .menu>li{position:relative}
        .link{display:flex;align-items:center;gap:10px;padding:12px;border-radius:12px;color:#e7f2f7;cursor:pointer}
        .link:hover{background:#013547}
        .submenu{display:none;margin:6px 0 10px 8px;border-left:2px solid rgba(255,255,255,.1);padding-left:8px}
        .submenu a{display:block;padding:8px 10px;border-radius:10px;color:#e7f2f7;text-decoration:none}
        .submenu a:hover{background:rgba(255,255,255,.08)}
        .menu>li.open>.submenu{display:block}
         .material-symbols-outlined-money {
             font-variation-settings:
                     'FILL' 0,
                     'wght' 400,
                     'GRAD' 0,
                     'opsz' 24
         }
    </style>
</head>
<body>
    <div th:fragment="menubar" class="sb">
        <ul class="menu" id="sideMenu">
            <li>
                <a class="link" th:href="@{/}">ğŸ  HOME</a>
            </li>

            <li>
                <div class="link" data-toggle>ğŸ‘¤ ë§ˆì´í˜ì´ì§€</div>
                <div class="submenu">
                    <a th:href="@{/mypage/profile}">ê°œì¸ì •ë³´ ì¡°íšŒ</a>
                    <a th:href="@{/mypage/update}">ê°œì¸ì •ë³´ ìˆ˜ì • ìš”ì²­</a>
                </div>
            </li>

            <li>
                <div class="link" data-toggle>ğŸ•’ ê·¼íƒœê´€ë¦¬</div>
                <div class="submenu">
                    <a th:href="@{/attend/main}">ê·¼íƒœ ë©”ì¸</a>
                    <a th:href="@{/attend/vacation}">íœ´ê°€ ì‹ ì²­</a>
                </div>
            </li>

            <li>
                <div class="link" data-toggle>ğŸ“ ì „ìê²°ì¬</div>
                <div class="submenu">
                    <a th:href="@{/approval/main}">ê²°ì¬ ë©”ì¸</a>
                    <a th:href="@{/approval/apply}">ì‹ ì²­</a>
                </div>
            </li>

            <li>
                <div class="link" data-toggle>âœ‰ï¸ ìª½ì§€</div>
                <div class="submenu">
                    <a th:href="@{/message/inbox}">ìˆ˜ì‹ í•¨</a>
                    <a th:href="@{/message/outbox}">ë°œì‹ í•¨</a>
                    <a th:href="@{/message/compose}">ìª½ì§€ ë³´ë‚´ê¸°</a>
                </div>
            </li>

            <li style="display:none">
                <div class="link" data-toggle>ğŸ§­ ì¸ì‚¬ê´€ë¦¬</div>
                <div class="submenu">
                    <a th:href="@{/hr/main}">ì¸ì‚¬ê´€ë¦¬ ë©”ì¸</a>
                    <a th:href="@{/hr/accounts}">ì‚¬ì› ê³„ì • ìƒì„±/ìˆ˜ì •/ì‚­ì œ</a>
                    <a th:href="@{/hr/integrated}">ì¸ì‚¬ í†µí•© ê´€ë¦¬</a>
                    <a th:href="@{/hr/attendance}">ê·¼íƒœ/íœ´ê°€ í†µí•©</a>
                    <a th:href="@{/hr/cert}">ì¦ëª…ì„œ ì¡°íšŒ/ë°œê¸‰</a>
                </div>
            </li>

            <li>
                <div class="link" data-toggle>
                    <span class="material-symbols-outlined">payment_arrow_down</span>
                    ê²½ì˜ê´€ë¦¬íŒ€
                </div>
                <div class="submenu">
                    <a th:href="@{/finance/main}">ê²½ì˜ê´€ë¦¬ ë©”ì¸</a>
                    <a th:href="@{/finance/payroll}">ê¸‰ì—¬ê´€ë¦¬</a>
                    <a th:href="@{/finance/revenue-report}">ë¶„ê¸°ë³„ ìˆ˜ìµì¡°íšŒ</a>
                    <a th:href="@{/finance/inventory}">ì¬ê³ í˜„í™© ì¡°íšŒ</a>
                </div>
            </li>

            <!-- ì§ì±…ë³„ ë…¸ì¶œ ì˜ˆì‹œ: ë¶€ì¥ ì´ìƒì¼ ë•Œë§Œ ì¡°ì§ë„ -->
            <li sec:authorize="hasAnyRole('MANAGER','ADMIN')">
                <a class="link" th:href="@{/org}">ğŸ§© ì¡°ì§ë„</a>
            </li>
        </ul>
    </div>

    <script>
        (function () {
          const menu = document.getElementById('sideMenu');
          if (!menu) return;

          // ì•„ì½”ë””ì–¸
          menu.addEventListener('click', (e) => {
            const btn = e.target.closest('.link[data-toggle]');
            if (!btn || !menu.contains(btn)) return;

            const li = btn.closest('li');
            const isOpen = li.classList.contains('open');

            menu.querySelectorAll(':scope > li.open').forEach((other) => {
              if (other !== li) {
                other.classList.remove('open');
                const hdr = other.querySelector(':scope > .link[data-toggle]');
                if (hdr) hdr.setAttribute('aria-expanded', 'false');
              }
            });

            li.classList.toggle('open', !isOpen);
            btn.setAttribute('aria-expanded', String(!isOpen));
          });

          // ì ‘ê·¼ì„±
          menu.querySelectorAll('.link[data-toggle]').forEach((hdr) => {
            hdr.setAttribute('aria-expanded', 'false');
            hdr.setAttribute('role', 'button');
            hdr.setAttribute('tabindex', '0');
          });

          // í‚¤ë³´ë“œ ì ‘ê·¼
          menu.addEventListener('keydown', (e) => {
            const isActivator = e.target.matches('.link[data-toggle]');
            if (!isActivator) return;
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              e.target.click();
            }
          });
        })();
    </script>
</body>
</html>